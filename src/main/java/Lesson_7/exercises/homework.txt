Игра "Кодовый Замок"

Описание задачи:
Ваша задача — реализовать консольную игру под названием "Кодовый Замок". Игроку нужно угадать секретный четырёхзначный код, установленный компьютером. Код состоит из цифр от 0 до 9, при этом каждая цифра встречается в коде ровно один раз. Игрок делает попытки угадать код, а программа сообщает, сколько цифр угадано и на правильных местах (называем их "ключи"), а также сколько цифр угадано, но они стоят не на своих местах (называем их "подсказки").
Правила игры:

    Компьютер случайным образом генерирует секретный код длиной 4 цифры (без повторяющихся цифр).
    Игрок вводит четырёхзначное число в качестве своей попытки.
    Программа проверяет, сколько цифр из введённого числа совпадают с секретным кодом и находятся на правильных местах — это "ключи".
    Программа также проверяет, сколько цифр угаданы, но находятся не на своих местах — это "подсказки".
    Игроку даётся максимум 10 попыток, чтобы угадать код.
    Если игрок угадал все цифры на правильных местах (4 ключа), игра считается выигранной.
    Если попытки закончились и игрок не угадал код, игра заканчивается поражением.
    Если игрок вводит неверное количество цифр или нецифровые символы, программа должна выбрасывать соответствующее исключение и просить ввести число заново.

Подсказки от программы:

    Ключи — количество цифр, которые точно угаданы и находятся на своих местах.
    Подсказки — количество цифр, которые угаданы, но стоят не на своих местах.

Пример:

    Секретный код: 3571.
    Попытка игрока: 3172.
    Программа должна выдать:
        Ключи: 1 (цифра 3 на правильном месте).
        Подсказки: 2 (цифры 1 и 7 угаданы, но не на правильных местах).

Требования к реализации:

    Используйте классы, методы и исключения для обработки ввода.
    Используйте массивы для хранения кода и попыток игрока.
    Реализуйте обработку некорректного ввода с выбросом пользовательского исключения InvalidInputException, если игрок вводит что-то, кроме четырех цифр.
    Используйте циклы для проверки цифр кода и ввода игрока.
    Игра должна завершаться либо победой, либо поражением (если игрок не угадал код за 10 попыток).
    Добавьте возможность после окончания игры (выигрыш или проигрыш) сыграть заново или выйти из программы.

Подсказка:

    Для генерации секретного кода без повторяющихся цифр можно использовать генерацию случайного числа, а затем проверку на уникальность каждой цифры.

Пример интерфейса игры:

Добро пожаловать в игру "Кодовый Замок"!
Компьютер сгенерировал секретный код. Ваша задача — угадать его.
У вас 10 попыток.

Попытка 1: Введите четырёхзначное число: 3172
Ключи: 1, Подсказки: 2

Попытка 2: Введите четырёхзначное число: 3571
Поздравляем! Вы угадали код! Вы выиграли!

Хотите сыграть ещё раз? (да/нет): нет
Спасибо за игру!

Эта игра похожа на "Быки и коровы", но отличается системой подсчета совпадений и условием уникальности цифр в коде.